{% extends "base.html" %}
{% block title %}{{ table_name|capitalize }}{% endblock %}

{% block content %}
<div class="dynamic-container dynamic-list-card">
  <header class="dynamic-list-header">
    <div>
      <span id="recordCount" class="dynamic-list-count text-muted small"></span>
    </div>
    <div class="dynamic-list-actions">
      <button id="btnFilterToggle" class="btn btn-outline-secondary btn-sm">
        <i class="fa fa-filter"></i>
        <span>Filtrar</span>
      </button>
      {% if user_perms[table_name].inserir %}
        <button id="btnNew" class="btn btn-primary btn-sm">
          <i class="fa fa-plus"></i>
          <span>Novo</span>
        </button>
      {% endif %}
    </div>
  </header>
  <div class="dynamic-grid-panel">
    <section id="grid" class="dynamic-grid"></section>
  </div>
</div>

<!-- Modal de Filtros -->
<div class="modal fade" id="modalFiltros" tabindex="-1" aria-labelledby="modalFiltrosLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalFiltrosLabel">Filtros</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body">
        <!-- O form sera injetado aqui pelo JS -->
        <form id="filter-form" class="filter-form"></form>
      </div>
      <div class="modal-footer">
        <div class="dynamic-form-modal-actions">
          <button type="button" class="btn btn-outline-secondary btn-cancel" data-bs-dismiss="modal">
            <i class="fa-solid fa-ban"></i>
            <span class="btn-text">Cancelar</span>
          </button>
          <button type="button" id="clearFilters" class="btn btn-outline-secondary btn-delete">
            <i class="fa-solid fa-rotate-left"></i>
            <span class="btn-text">Limpar</span>
          </button>
          <button type="button" id="applyFilters" class="btn btn-outline-primary btn-save">
            <i class="fa-solid fa-check"></i>
            <span class="btn-text">Aplicar</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  window.TABLE_NAME = "{{ table_name }}";
  window.TABLE_FORM = {{ menu_forms.get(table_name)|tojson }};
</script>
<script src="{{ url_for('static', filename='js/dynamic_list.js') }}"></script>
{% endblock %}
